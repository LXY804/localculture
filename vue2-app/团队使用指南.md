# 🎉 团队快速上手指南

欢迎加入本地文化平台项目！本指南将帮助你在15分钟内完成环境配置并成功运行项目。

---

## 📋 环境要求

请确保你的电脑已安装以下软件：

- ✅ **Node.js** (v14.0+ 推荐 v16+) - [下载地址](https://nodejs.org/)
- ✅ **MySQL** (v5.7+ 或 v8.0+) - [下载地址](https://dev.mysql.com/downloads/mysql/)
- ✅ **Git** - [下载地址](https://git-scm.com/)

---

## 🚀 运行项目 - 6个步骤

### 第一步：获取代码

```bash
# 克隆项目（如果还没有）
git clone <项目地址>
cd vue2-app

# 或者如果已有代码，拉取最新版本
git pull origin main
```

### 第二步：运行初始化脚本

**Windows 用户：**
在项目根目录 `vue2-app` 下，双击运行：
```
setup-for-new-member.bat
```

**Linux/Mac 用户：**
```bash
chmod +x setup-for-new-member.sh
./setup-for-new-member.sh
```

这个脚本会自动：
- ✅ 检查 Node.js 环境
- ✅ 安装项目依赖 (`npm install`)
- ✅ 检查/创建 `.env` 配置文件
- ✅ 创建必要的目录
- ✅ 复制图片资源

### 第三步：配置数据库密码

1. 在 `vue2-app` 目录下找到 `.env` 文件（如果没有会自动创建）
2. 修改以下内容：

```env
# 数据库配置（改成你自己的MySQL密码）
DB_HOST=localhost
DB_USER=root
DB_PASSWORD=你的MySQL密码
DB_NAME=localculture
DB_PORT=3306

# 服务器配置
PORT=3001

# JWT配置（保持默认即可）
JWT_SECRET=localculture_secret_2025
```

⚠️ **重要**：`DB_PASSWORD` 改成你自己的 MySQL root 密码！

### 第四步：创建并导入数据库

⚠️ **重要**：SQL文件必须按照以下顺序执行，否则可能出现错误！

#### 📋 SQL文件执行顺序说明

```
第1步：schema.sql（必选）
  └─ 创建核心表结构（users, articles, forum_posts等基础表）

第2步：create-categories-tags-tables.sql（可选）
  └─ 创建分类和标签的规范化表（如果使用规范化设计）

第3步：create-dashboard-tables.sql（可选）
  └─ 创建仪表盘统计相关表（如果需要数据统计功能）

第4步：data.sql（必选）
  └─ 插入基础数据（用户、文章、论坛等数据）

第5步：announcements-data.sql（可选）
  └─ 插入公告数据（如果需要公告数据）

第6步：fix-articles-data.sql（可选）
  └─ 修复文章数据，同步hotarticles到articles表

第7步：fix-article-tags-associations.sql（可选）
  └─ 修复文章标签关联关系（依赖第2步）

第8步：update-articles-tags-categories.sql（可选）
  └─ 更新文章的分类和标签
```

#### ⚠️ 重要提示

1. **必须按顺序执行**：
   - 必须先创建表结构（`schema.sql`），再插入数据（`data.sql`）
   - 顺序错误会导致外键约束错误或数据插入失败

2. **依赖关系**：
   - `fix-article-tags-associations.sql` 需要先执行 `create-categories-tags-tables.sql`
   - 如果跳过第2步，第7步会失败

3. **每步检查错误**：
   - 每执行一个SQL文件后，必须检查是否有错误信息
   - 如果有错误，先解决问题再继续下一步

4. **最小安装方案**：
   - 如果只想快速运行项目，只需执行：
     - 第1步：`schema.sql`
     - 第4步：`data.sql`
   - 其他步骤都是可选的功能扩展

5. **重新安装时**：
   - 如果表已存在，建议先删除数据库重新创建：
     ```sql
     DROP DATABASE IF EXISTS localculture;
     CREATE DATABASE localculture DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
     ```

6. **执行顺序图**：
   ```
   创建数据库
       ↓
   schema.sql (必选) ──────────────┐
       ↓                          │
   create-categories-tags-        │
   tables.sql (可选)              │
       ↓                          │
   create-dashboard-tables.sql    │
   (可选)                         │
       ↓                          │
   data.sql (必选) ←──────────────┘
       ↓
   announcements-data.sql (可选)
       ↓
   fix-articles-data.sql (可选)
       ↓
   fix-article-tags-associations.sql (可选，依赖第2步)
       ↓
   update-articles-tags-categories.sql (可选)
   ```

#### 方法一：命令行导入（推荐，Windows/Mac通用）

**基础安装（必选）：**
```bash
# 1. 创建数据库（将"你的密码"替换为实际密码）
mysql -u root -p你的密码 -e "CREATE DATABASE IF NOT EXISTS localculture DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;"

# 2. 导入核心表结构（必须第一步）
mysql -u root -p你的密码 localculture < sql/schema.sql

# 3. 导入基础数据（必须第二步）
mysql -u root -p你的密码 localculture < sql/data.sql
```

**完整安装（包含所有功能）：**
```bash
# 1. 创建数据库
mysql -u root -p你的密码 -e "CREATE DATABASE IF NOT EXISTS localculture DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;"

# 2. 导入核心表结构
mysql -u root -p你的密码 localculture < sql/schema.sql

# 3. 创建分类和标签表（如果需要规范化设计）
mysql -u root -p你的密码 localculture < sql/create-categories-tags-tables.sql

# 4. 创建仪表盘表（如果需要数据统计）
mysql -u root -p你的密码 localculture < sql/create-dashboard-tables.sql

# 5. 导入基础数据
mysql -u root -p你的密码 localculture < sql/data.sql

# 6. 导入公告数据（可选）
mysql -u root -p你的密码 localculture < sql/announcements-data.sql

# 7. 修复文章数据（可选）
mysql -u root -p你的密码 localculture < sql/fix-articles-data.sql

# 8. 修复文章标签关联（可选，需要先执行create-categories-tags-tables.sql）
mysql -u root -p你的密码 localculture < sql/fix-article-tags-associations.sql

# 9. 更新文章分类和标签（可选）
mysql -u root -p你的密码 localculture < sql/update-articles-tags-categories.sql
```

**快速安装（最小化，仅核心功能）：**
```bash
# 仅执行必需的文件
mysql -u root -p你的密码 -e "CREATE DATABASE IF NOT EXISTS localculture DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;"
mysql -u root -p你的密码 localculture < sql/schema.sql
mysql -u root -p你的密码 localculture < sql/data.sql
```

#### 方法二：手动导入（适合新手，使用图形化工具）

1. 打开 **MySQL Workbench** 或 **Navicat** 等数据库管理工具
2. 连接到 MySQL 服务器
3. 创建数据库：
   ```sql
   CREATE DATABASE IF NOT EXISTS localculture 
   DEFAULT CHARACTER SET utf8mb4 
   COLLATE utf8mb4_general_ci;
   ```
4. 选择 `localculture` 数据库
5. **按顺序执行以下SQL文件**（非常重要！）：
   - 第1步：执行 `sql/schema.sql`（创建表结构）
   - 第2步：执行 `sql/data.sql`（插入基础数据）
   - （可选）第3步：执行 `sql/create-categories-tags-tables.sql`
   - （可选）第4步：执行 `sql/create-dashboard-tables.sql`
   - （可选）第5步：执行 `sql/announcements-data.sql`
   - （可选）第6步：执行 `sql/fix-articles-data.sql`
6. 检查每个步骤是否有错误信息

#### 方法三：PowerShell 脚本（Windows）

在 PowerShell 中执行（每条命令会提示输入密码，按顺序执行）：

**基础安装：**
```powershell
# 1. 导入核心表结构（必须先执行）
Get-Content sql\schema.sql | mysql -u root -p localculture

# 2. 导入基础数据（必须第二步）
Get-Content sql\data.sql | mysql -u root -p localculture
```

**完整安装（包含所有功能）：**
```powershell
# 1. 核心表结构
Get-Content sql\schema.sql | mysql -u root -p localculture

# 2. 分类和标签表（可选）
Get-Content sql\create-categories-tags-tables.sql | mysql -u root -p localculture

# 3. 仪表盘表（可选）
Get-Content sql\create-dashboard-tables.sql | mysql -u root -p localculture

# 4. 基础数据
Get-Content sql\data.sql | mysql -u root -p localculture

# 5. 公告数据（可选）
Get-Content sql\announcements-data.sql | mysql -u root -p localculture

# 6. 修复文章数据（可选）
Get-Content sql\fix-articles-data.sql | mysql -u root -p localculture

# 7. 修复标签关联（可选，需要先执行create-categories-tags-tables.sql）
Get-Content sql\fix-article-tags-associations.sql | mysql -u root -p localculture
```

⚠️ **注意**：每次执行后，确认没有错误再执行下一步！

### 第五步：启动项目

**Windows 用户：**
在项目根目录双击运行：
```
start.bat
```

**Linux/Mac 用户：**
```bash
chmod +x start.sh
./start.sh
```

**或使用 npm 命令：**
```bash
npm run dev
```

这会自动启动：
- 🔧 **后端服务器** - http://localhost:3001
- 🌐 **前端服务器** - http://localhost:8080

✅ **验证启动成功**：
- 看到两个命令行窗口弹出
- 后端窗口显示 `服务器运行在端口 3001`
- 前端窗口显示 `App running at http://localhost:8080`
- 浏览器访问 http://localhost:8080 能看到页面

### 第六步：访问应用

- **前端首页**：http://localhost:8080
- **后端API**：http://localhost:3001/api
- **默认管理员账号**：查看 `sql/data.sql` 或询问项目负责人

---

## ✅ 验证是否成功运行

请确认以下检查项：

- [ ] 两个服务器都成功启动（后端3001，前端8080）
- [ ] 浏览器能打开 http://localhost:8080
- [ ] 能正常登录系统
- [ ] 没有控制台错误（F12打开浏览器控制台检查）
- [ ] 数据库连接正常（后端控制台无数据库错误）

---

## ❓ 常见问题

### 1. 数据库连接失败？

**症状**：启动后端时显示 `❌ 数据库连接失败`

**解决步骤**：
1. 检查 MySQL 服务是否正在运行
   ```bash
   # Windows
   net start mysql
   
   # 或检查服务状态
   services.msc  # 查找 MySQL 服务
   ```
2. 检查 `.env` 文件中的 `DB_PASSWORD` 是否正确
3. 确认数据库 `localculture` 已创建
   ```bash
   mysql -u root -p你的密码 -e "SHOW DATABASES;"
   ```
4. 测试数据库连接
   ```bash
   mysql -u root -p你的密码 -e "USE localculture; SELECT 1;"
   ```

---

### 2. 端口被占用？

**症状**：提示端口 3001 或 8080 已被占用

**解决步骤（Windows）：**
```powershell
# 查找占用端口的进程
netstat -ano | findstr :3001
netstat -ano | findstr :8080

# 结束进程（替换<PID>为实际进程ID）
taskkill /PID <PID> /F
```

**解决步骤（Linux/Mac）：**
```bash
# 查找占用端口的进程
lsof -i :3001
lsof -i :8080

# 结束进程（替换<PID>为实际进程ID）
kill -9 <PID>
```

或者修改端口：
- 后端端口：修改 `.env` 中的 `PORT=3002`
- 前端端口：修改 `vue.config.js` 中的 `port: 8081`

---

### 3. npm install 失败？

**症状**：安装依赖时出现错误

**解决步骤**：
1. 清除 npm 缓存
   ```bash
   npm cache clean --force
   ```
2. 删除并重新安装
   ```bash
   # 删除 node_modules 和 package-lock.json
   rm -rf node_modules package-lock.json
   
   # 重新安装
   npm install
   ```
3. 使用国内镜像（如果网络问题）
   ```bash
   npm install --registry=https://registry.npmmirror.com
   ```

---

### 4. 数据库导入失败？

**症状**：执行 SQL 文件时出现错误

**解决步骤**：
1. 确保 MySQL 服务正在运行
2. 检查 SQL 文件编码（应为 UTF-8）
3. 检查数据库字符集
   ```sql
   SHOW CREATE DATABASE localculture;
   -- 应该显示 utf8mb4
   ```
4. **严格按照顺序导入**，分步执行：
   - 第1步：先导入 `schema.sql`（创建表结构）
   - 第2步：再导入 `data.sql`（插入数据）
   - 第3步：然后导入其他可选文件
   - 每步执行后检查是否有错误信息
5. 如果表已存在，先删除数据库重新创建：
   ```sql
   DROP DATABASE IF EXISTS localculture;
   CREATE DATABASE localculture DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
   ```

---

### 5. 前端页面空白？

**症状**：浏览器打开页面显示空白或报错

**解决步骤**：
1. 清除浏览器缓存（Ctrl + Shift + Delete）
2. 检查后端服务是否正常运行
   - 访问 http://localhost:3001/api
   - 应该能看到 API 响应或错误信息
3. 查看浏览器控制台（F12）的具体错误
4. 确认前端依赖已正确安装
   ```bash
   npm install
   ```

---

### 6. 论坛页面是空的？

**症状**：论坛列表没有帖子

**解决步骤**：
1. 确认导入了 `data.sql`
2. 检查数据库中 `forum_posts` 表是否有数据
   ```sql
   SELECT id, title, visible, status FROM forum_posts;
   ```
3. 确保帖子的 `visible = 1` 且 `status = 'published'`
   ```sql
   UPDATE forum_posts SET visible = 1, status = 'published' WHERE visible = 0 OR status IS NULL;
   ```

---

## 🛑 停止服务

**Windows：**
- 关闭两个命令行窗口
- 或运行 `stop.bat`

**Linux/Mac：**
```bash
# 查找进程
ps aux | grep node

# 结束进程
pkill -f "node.*index.js"
pkill -f "vue-cli-service"
```

---

## 💬 需要帮助？

如果遇到问题：

1. 📖 检查上面的"常见问题"部分
2. 📄 查看项目根目录下的其他文档：
   - `STARTUP_GUIDE.md` - 详细启动指南
   - `README.md` - 项目说明
   - `COLLABORATION_GUIDE.md` - 协作指南
3. 🔍 查看代码注释和日志
4. 👥 联系项目负责人或团队成员

---

## 🎯 下一步

成功运行项目后，建议：

1. ✅ 熟悉项目目录结构
2. ✅ 阅读主要组件代码
3. ✅ 了解数据库表结构（查看 `sql/schema.sql`）
4. ✅ 尝试使用系统的各项功能
5. ✅ 查看团队的开发规范文档

---

**祝你开发顺利！🎉**
